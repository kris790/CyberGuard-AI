import React from 'react';
import { Severity } from '../types';
import type { Vulnerability } from '../types';

const severityStyles: Record<Severity, { bg: string; text: string }> = {
  [Severity.Critical]: { bg: 'bg-red-500/20', text: 'text-red-400' },
  [Severity.High]: { bg: 'bg-orange-500/20', text: 'text-orange-400' },
  [Severity.Medium]: { bg: 'bg-yellow-500/20', text: 'text-yellow-400' },
  [Severity.Low]: { bg: 'bg-blue-500/20', text: 'text-blue-400' },
  [Severity.Info]: { bg: 'bg-gray-500/20', text: 'text-gray-400' },
};

interface VulnerabilityListProps {
  vulnerabilities: Vulnerability[];
  onSelect: (vulnerability: Vulnerability) => void;
  selectedId: string | null;
}

const VulnerabilityList: React.FC<VulnerabilityListProps> = ({ vulnerabilities, onSelect, selectedId }) => {
  return (
    <div className="overflow-x-auto">
      <table className="w-full text-left">
        <thead className="bg-gray-700/50">
          <tr>
            <th className="p-4 text-sm font-semibold text-gray-300">Identifier</th>
            <th className="p-4 text-sm font-semibold text-gray-300">Description</th>
            <th className="p-4 text-sm font-semibold text-gray-300">Asset</th>
            <th className="p-4 text-sm font-semibold text-gray-300">Severity</th>
          </tr>
        </thead>
        <tbody>
          {vulnerabilities.map((vuln) => (
            <tr 
              key={vuln.id}
              onClick={() => onSelect(vuln)}
              className={`cursor-pointer border-b border-gray-700 hover:bg-gray-700/50 ${selectedId === vuln.id ? 'bg-blue-600/20' : ''}`}
            >
              <td className="p-4 text-sm font-medium text-white">{vuln.id}</td>
              <td className="p-4 text-sm text-gray-300 max-w-xs truncate">{vuln.description}</td>
              {/* Fix: Use correct property 'affectedAsset' instead of 'asset' */}
              <td className="p-4 text-sm text-gray-300">{vuln.affectedAsset}</td>
              <td className="p-4 text-sm">
                <span className={`px-2 py-1 rounded-full text-xs font-semibold ${severityStyles[vuln.severity].bg} ${severityStyles[vuln.severity].text}`}>
                  {vuln.severity}
                </span>
              </td>
            </tr>
          ))}
        </tbody>
      </table>
    </div>
  );
};

export default VulnerabilityList;